**0. 进行平滑**

- 使用PAEK算法进行平滑
- （**指数核的多项式近似 (PAEK)** 方法（Python 中的 **PAEK**）根据平滑容差对面进行平滑处理。 每个面经过平滑处理后，其折点都可能比之前多。 **平滑容差**参数可控制计算新折点时用到的“移动”路径的长度。 长度越短，保留的细节越多，处理时间也越长。）

**1. 加载数据**

- 加载河流中心线数据和平滑后的中心线数据，这些数据存储在Shapefile文件中（例如，`中心线平滑.shp`、`PEAK_SM2_1000.shp` 等）。
- 加载南北边界线数据，该数据也存储在Shapefile文件中（`南北线_修改后.shp`）。
- 加载清沟数据，该数据存储在另一个Shapefile文件中（`20230305清沟_hz.shp`）。

**2. 合并中心线**

- 将加载的中心线数据进行合并，生成一条连续的中心线。
- 合并后的中心线数据会被缓存到JSON文件中，以便后续使用。

**3. 分割南北边界线**

- 将加载的南北边界线数据进行分割，生成北边界线和南边界线。
- 分割后的边界线数据会被缓存到JSON文件中，以便后续使用。

**4. 生成法线**

- 在合并后的中心线上生成法线，法线的方向垂直于中心线，并指向南北边界线。
- 去除掉相交的法线（使用R tree算法进行优化）
- 法线数据会被缓存到JSON文件中，以便后续使用。

**5. 构建封闭图形**

- 利用法线和南北边界线数据构建封闭图形，这些封闭图形可以近似地表示河流的横截面。
- （上一步中如果出现了南线或北线过长（超过500m），需要每隔500m连接南北两个边界线）
- 封闭图形数据会被缓存到JSON文件中，以便后续使用。

**6. 处理清沟数据**

- 获取清沟两个端点 在哪个封闭图形中，然后求出两个端点分别到南岸，北岸和中心线的投影点，两个北岸投影点求出子线段，两个南岸投影点求出子线段，两个中心线投影点求出子线段，这三组子线段，作为清沟长度的近似值


结果图
![img.png](img.png)